<div>
   <h1> RepoData for <%= @repo.name %> </h1>

<% repo_traffic_data = RepoData::RepoTrafficDataViewsDaily.where(repo: @repo) %>
<%# repo_views = repo_traffic_data.map { |data| [data.timestamp, data.count] } %>
<%# repo_uniques = repo_traffic_data.map { |data| [data.timestamp, data.uniques] } %>
 <%#= repo_uniques %>

<%# repo_views = repo_traffic_data.map { |data| [data.timestamp, data.count] } %>
<%# repo_uniques = repo_traffic_data.map { |data| [data.timestamp, data.uniques] } %>
    <%#= line_chart repo_uniques, xtitle: "Time", ytitle: "Count" %>

<% repo_views = repo_traffic_data.map { |data| [data.timestamp, data.count] } %>
<% repo_uniques = repo_traffic_data.map { |data| [data.timestamp, data.uniques] } %>

<% combined_data = [
  { name: 'Views', data: repo_views.to_h },
  { name: 'Uniques', data: repo_uniques.to_h }
] %>

<%= line_chart combined_data %>


    <h2> Traffic </h2>
        <table class="table-auto border-collapse border border-gray-200 w-full text-left">
        <thead>
            <tr class="bg-gray-100">
            <th class="border border-gray-300 px-4 py-2">Timestamp</th>
            <th class="border border-gray-300 px-4 py-2">Views</th>
            <th class="border border-gray-300 px-4 py-2">Unique Views</th>
            </tr>
        </thead>
        <tbody>
            <% repo_traffic_data.each do |repo_traffic| %>
            <tr class="hover:bg-gray-50">
                <td class="border border-gray-300 px-4 py-2"><%= repo_traffic.timestamp %></td>
                <td class="border border-gray-300 px-4 py-2"><%= repo_traffic.count %></td>
                <td class="border border-gray-300 px-4 py-2"><%= repo_traffic.uniques %></td>
            </tr>
            <% end %>
        </tbody>
        </table>

    
</div>
